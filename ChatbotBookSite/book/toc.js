// Populate the sidebar
//
// This is a script, and not included directly in the page, to control the total size of the book.
// The TOC contains an entry for each page, so if each page includes a copy of the TOC,
// the total size of the page becomes O(n**2).
class MDBookSidebarScrollbox extends HTMLElement {
    constructor() {
        super();
    }
    connectedCallback() {
        this.innerHTML = '<ol class="chapter"><li class="chapter-item expanded affix "><a href="0000_foreword_and_introduction.html">Foreword and Introduction</a></li><li class="chapter-item expanded affix "><a href="0001_table_of_contents.html">Table of Contents</a></li><li class="chapter-item expanded affix "><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Main Content</li><li class="chapter-item expanded "><a href="0002_chapter_1_how_llms_work.html">Chapter 1 – How LLMs Work</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="0003_11_what_an_llm_really_is.html">1.1 What an LLM Really Is</a></li><li class="chapter-item expanded "><a href="0004_12_tokens_the_building_blocks_of_thought.html">1.2 Tokens: The Building Blocks of Thought</a></li><li class="chapter-item expanded "><a href="0005_13_permanent_vs_temporary_tokens.html">1.3 Permanent vs. Temporary Tokens</a></li><li class="chapter-item expanded "><a href="0006_14_context_windows_the_bots_short_term_memory.html">1.4 Context Windows: The Bot’s Short-Term Memory</a></li><li class="chapter-item expanded "><a href="0007_15_pretraining_and_why_lore_dumps_fail.html">1.5 Pretraining and Why Lore Dumps Fail</a></li><li class="chapter-item expanded "><a href="0008_16_how_prompts_are_sent_send_order.html">1.6 How Prompts Are Sent (Send Order)</a></li><li class="chapter-item expanded "><a href="0009_17_why_bots_drift.html">1.7 Why Bots Drift</a></li><li class="chapter-item expanded "><a href="0010_exercises.html">Exercises</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="0011_chapter_2_token_efficiency_memory_management.html">Chapter 2 – Token Efficiency &amp; Memory Management</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="0012_21_why_efficiency_matters.html">2.1 Why Efficiency Matters</a></li><li class="chapter-item expanded "><a href="0013_22_the_token_budget.html">2.2 The Token Budget</a></li><li class="chapter-item expanded "><a href="0014_23_placement_and_the_u_shaped_curve.html">2.3 Placement and the U-Shaped Curve</a></li><li class="chapter-item expanded "><a href="0015_24_reply_length_and_pacing.html">2.4 Reply Length and Pacing</a></li><li class="chapter-item expanded "><a href="0016_25_cutting_the_fat.html">2.5 Cutting the Fat</a></li><li class="chapter-item expanded "><a href="0017_26_collapse_and_condense.html">2.6 Collapse and Condense</a></li><li class="chapter-item expanded "><a href="0018_27_signal_vs_noise.html">2.7 Signal vs. Noise</a></li><li class="chapter-item expanded "><a href="0019_28_confusion_drift.html">2.8 Confusion Drift</a></li><li class="chapter-item expanded "><a href="0020_29_final_takeaways.html">2.9 Final Takeaways</a></li><li class="chapter-item expanded "><a href="0021_exercises.html">Exercises</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="0022_chapter_3_personality_blocks_i_structure_theory.html">Chapter 3 – Personality Blocks I: Structure &amp; Theory</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="0023_31_what_a_personality_block_is.html">3.1 What a Personality Block Is</a></li><li class="chapter-item expanded "><a href="0024_32_the_formula_personality_block_template.html">3.2 The Formula: Personality Block Template</a></li><li class="chapter-item expanded "><a href="0025_33_teaching_each_section.html">3.3 Teaching Each Section</a></li><li class="chapter-item expanded "><a href="0026_34_worked_example_susan_benson.html">3.4 Worked Example: Susan Benson</a></li><li class="chapter-item expanded "><a href="0027_35_common_mistakes.html">3.5 Common Mistakes</a></li><li class="chapter-item expanded "><a href="0028_36_exercises.html">3.6 Exercises</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="0029_chapter_4_scenario_blocks_i_the_identity_vs_the_script.html">Chapter 4 – Scenario Blocks I: The Identity vs. the Script</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="0030_41_what_a_scenario_block_is.html">4.1 What a Scenario Block Is</a></li><li class="chapter-item expanded "><a href="0031_42_why_the_scenario_block_matters.html">4.2 Why the Scenario Block Matters</a></li><li class="chapter-item expanded "><a href="0032_43_the_formula_scenario_block_template.html">4.3 The Formula: Scenario Block Template</a></li><li class="chapter-item expanded "><a href="0033_44_teaching_each_section.html">4.4 Teaching Each Section</a></li><li class="chapter-item expanded "><a href="0034_45_worked_example_susan_benson.html">4.5 Worked Example: Susan Benson</a></li><li class="chapter-item expanded "><a href="0035_46_common_mistakes.html">4.6 Common Mistakes</a></li><li class="chapter-item expanded "><a href="0036_47_exercises.html">4.7 Exercises</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="0037_chapter_5_scenario_blocks_ii_states_triggers_and_interaction.html">Chapter 5 – Scenario Blocks II: States, Triggers, and Interaction Categories</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="0038_51_why_states_and_triggers_matter.html">5.1 Why States and Triggers Matter</a></li><li class="chapter-item expanded "><a href="0039_52_defining_states.html">5.2 Defining States</a></li><li class="chapter-item expanded "><a href="0040_53_writing_triggers.html">5.3 Writing Triggers</a></li><li class="chapter-item expanded "><a href="0041_54_interaction_categories_expanded.html">5.4 Interaction Categories Expanded</a></li><li class="chapter-item expanded "><a href="0042_55_worked_example_triggered_states_in_play.html">5.5 Worked Example: Triggered States in Play</a></li><li class="chapter-item expanded "><a href="0043_56_common_mistakes.html">5.6 Common Mistakes</a></li><li class="chapter-item expanded "><a href="0044_57_exercises.html">5.7 Exercises</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="0045_chapter_6_example_dialogue.html">Chapter 6 – Example Dialogue</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="0046_61_why_example_dialogue_matters.html">6.1 Why Example Dialogue Matters</a></li><li class="chapter-item expanded "><a href="0047_62_formatting_conventions.html">6.2 Formatting Conventions</a></li><li class="chapter-item expanded "><a href="0048_63_pacing_tricks.html">6.3 Pacing Tricks</a></li><li class="chapter-item expanded "><a href="0049_64_example_dialogue_good_vs_bad.html">6.4 Example Dialogue (Good vs. Bad)</a></li><li class="chapter-item expanded "><a href="0050_65_building_a_sample_set.html">6.5 Building a Sample Set</a></li><li class="chapter-item expanded "><a href="0051_66_key_takeaways.html">6.6 Key Takeaways</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="0052_chapter_7_initial_messages_first_impressions.html">Chapter 7 – Initial Messages &amp; First Impressions</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="0053_71_the_curtain_rises.html">7.1 The Curtain Rises</a></li><li class="chapter-item expanded "><a href="0054_72_anatomy_of_an_effective_opener.html">7.2 Anatomy of an Effective Opener</a></li><li class="chapter-item expanded "><a href="0055_73_case_study_ninas_room.html">7.3 Case Study: Nina’s Room</a></li><li class="chapter-item expanded "><a href="0056_74_why_length_matters.html">7.4 Why Length Matters</a></li><li class="chapter-item expanded "><a href="0057_75_common_pitfalls.html">7.5 Common Pitfalls</a></li><li class="chapter-item expanded "><a href="0058_76_alternative_openers_across_archetypes.html">7.6 Alternative Openers Across Archetypes</a></li><li class="chapter-item expanded "><a href="0059_77_practical_design_tips.html">7.7 Practical Design Tips</a></li><li class="chapter-item expanded "><a href="0060_78_conclusion_the_first_beat.html">7.8 Conclusion: The First Beat</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="0061_chapter_8_bot_cards_presentation.html">Chapter 8 – Bot Cards &amp; Presentation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="0062_81_why_bot_cards_matter.html">8.1 Why Bot Cards Matter</a></li><li class="chapter-item expanded "><a href="0063_82_the_six_structural_parts_of_a_card.html">8.2 The Six Structural Parts of a Card</a></li><li class="chapter-item expanded "><a href="0064_83_visuals_and_generators.html">8.3 Visuals and Generators</a></li><li class="chapter-item expanded "><a href="0065_84_prompting_basics.html">8.4 Prompting Basics</a></li><li class="chapter-item expanded "><a href="0066_85_writing_the_blurb.html">8.5 Writing the Blurb</a></li><li class="chapter-item expanded "><a href="0067_86_structural_flow_checklist.html">8.6 Structural Flow Checklist</a></li><li class="chapter-item expanded "><a href="0068_87_worked_example_tomboy_judo_girlfriend.html">8.7 Worked Example: Tomboy Judo Girlfriend</a></li><li class="chapter-item expanded "><a href="0069_88_common_mistakes.html">8.8 Common Mistakes</a></li><li class="chapter-item expanded "><a href="0070_89_conclusion_the_storefront_window.html">8.9 Conclusion: The Storefront Window</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="0071_chapter_9_testing_debugging_bots.html">Chapter 9 – Testing &amp; Debugging Bots</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="0072_91_why_testing_matters.html">9.1 Why Testing Matters</a></li><li class="chapter-item expanded "><a href="0073_92_the_testers_mindset.html">9.2 The Tester’s Mindset</a></li><li class="chapter-item expanded "><a href="0074_93_quick_checks_for_tone.html">9.3 Quick Checks for Tone</a></li><li class="chapter-item expanded "><a href="0075_94_quick_checks_for_scenario_rules.html">9.4 Quick Checks for Scenario Rules</a></li><li class="chapter-item expanded "><a href="0076_95_quick_checks_for_emotion.html">9.5 Quick Checks for Emotion</a></li><li class="chapter-item expanded "><a href="0077_96_quick_checks_for_tokens.html">9.6 Quick Checks for Tokens</a></li><li class="chapter-item expanded "><a href="0078_97_pitfalls_in_debugging.html">9.7 Pitfalls in Debugging</a></li><li class="chapter-item expanded "><a href="0079_98_case_studies.html">9.8 Case Studies</a></li><li class="chapter-item expanded "><a href="0080_99_common_pitfalls.html">9.9 Common Pitfalls</a></li><li class="chapter-item expanded "><a href="0081_910_debugging_quick_checklist.html">9.10 Debugging Quick Checklist</a></li><li class="chapter-item expanded "><a href="0082_911_conclusion.html">9.11 Conclusion</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="0083_chapter_10_multi_character_philosophy.html">Chapter 10 – Multi-Character Philosophy</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="0084_101_introduction_from_solos_to_ensembles.html">10.1 Introduction: From Solos to Ensembles</a></li><li class="chapter-item expanded "><a href="0085_102_the_core_challenge_many_voices_one_engine.html">10.2 The Core Challenge: Many Voices, One Engine</a></li><li class="chapter-item expanded "><a href="0086_103_the_scenario_as_director.html">10.3 The Scenario as Director</a></li><li class="chapter-item expanded "><a href="0087_104_efficiency_and_token_management.html">10.4 Efficiency and Token Management</a></li><li class="chapter-item expanded "><a href="0088_105_from_solo_act_to_ensemble_cast.html">10.5 From Solo Act to Ensemble Cast</a></li><li class="chapter-item expanded "><a href="0089_106_case_illustration_the_two_voice_test.html">10.6 Case Illustration: The Two-Voice Test</a></li><li class="chapter-item expanded "><a href="0090_107_conclusion.html">10.7 Conclusion</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="0091_chapter_11_multi_part_personality_blocks.html">Chapter 11 – Multi-Part Personality Blocks</a></li><li class="chapter-item expanded affix "><li class="spacer"></li><li class="chapter-item expanded "><a href="0092_chapter_12_the_shared_scenario_trigger_matrix.html">Chapter 12 – The Shared Scenario &amp; Trigger Matrix</a></li><li class="chapter-item expanded affix "><li class="spacer"></li><li class="chapter-item expanded "><a href="0093_12a_template_dual_character_shared_scenario_trigger_matrix.html">12.A Template: Dual-Character Shared Scenario &amp; Trigger Matrix</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="0094_12b_template_trio_character_shared_scenario_trigger_matrix.html">12.B Template: Trio-Character Shared Scenario &amp; Trigger Matrix</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="0095_chapter_13_dialogue_formatting_troubleshooting.html">Chapter 13 – Dialogue, Formatting &amp; Troubleshooting</a></li><li class="chapter-item expanded affix "><li class="spacer"></li><li class="chapter-item expanded "><a href="0096_chapter_14_scenario_bots_i_foundations_simulation.html">Chapter 14 – Scenario Bots I: Foundations &amp; Simulation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="0097_141_what_are_scenario_bots.html">14.1 What Are Scenario Bots?</a></li><li class="chapter-item expanded "><a href="0098_142_personality_vs_scenario_revisited.html">14.2 Personality vs. Scenario Revisited</a></li><li class="chapter-item expanded "><a href="0099_143_the_controller_block_world_personality.html">14.3 The Controller Block (World Personality)</a></li><li class="chapter-item expanded "><a href="0100_144_the_scenario_block_simulation_engine.html">14.4 The Scenario Block (Simulation Engine)</a></li><li class="chapter-item expanded "><a href="0101_145_pacing_cycles_gameplay_loops.html">14.5 Pacing Cycles &amp; Gameplay Loops</a></li><li class="chapter-item expanded "><a href="0102_146_advanced_behavioral_logic_part_i.html">14.6 Advanced Behavioral Logic (Part I)</a></li><li class="chapter-item expanded "><a href="0103_147_worked_example_dbz_saiyan_saga_scenario_bot.html">14.7 Worked Example – DBZ “Saiyan Saga” Scenario Bot</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="0104_chapter_15_scenario_bots_ii_advanced_builds_templates.html">Chapter 15 – Scenario Bots II: Advanced Builds &amp; Templates</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="0105_151_why_advanced_practice_matters.html">15.1 Why Advanced Practice Matters</a></li><li class="chapter-item expanded "><a href="0106_152_worked_example_slice_of_life_campus_bot.html">15.2 Worked Example: Slice-of-Life Campus Bot</a></li><li class="chapter-item expanded "><a href="0107_153_common_pitfalls.html">15.3 Common Pitfalls</a></li><li class="chapter-item expanded "><a href="0108_154_fill_it_yourself_templates.html">15.4 Fill-It-Yourself Templates</a></li><li class="chapter-item expanded "><a href="0109_155_testing_iteration.html">15.5 Testing &amp; Iteration</a></li><li class="chapter-item expanded "><a href="0110_156_diagram_prompt.html">15.6 Diagram Prompt</a></li><li class="chapter-item expanded "><a href="0111_157_glossary_scenario_specific.html">15.7 Glossary (Scenario-Specific)</a></li><li class="chapter-item expanded "><a href="0112_158_conclusion.html">15.8 Conclusion</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="0113_chapter_16_wrap_up.html">Chapter 16 – Wrap-Up</a></li><li class="chapter-item expanded affix "><li class="spacer"></li><li class="chapter-item expanded "><a href="0114_appendix_1_spark_notes_most_important_things.html">Appendix 1 – Spark Notes / Most Important Things</a></li><li class="chapter-item expanded affix "><li class="spacer"></li><li class="chapter-item expanded "><a href="0115_appendix_2_single_character_personality_scenario.html">Appendix 2 – Single-Character Personality &amp; Scenario</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="0116_personality_template.html">Personality Template</a></li><li class="chapter-item expanded "><a href="0117_scenario_template.html">Scenario Template</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="0118_appendix_3_dual_character_personality_scenario_templates.html">Appendix 3 – Dual-Character Personality &amp; Scenario Templates</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="0119_dual_character_personality_template.html">Dual-Character Personality Template</a></li><li class="chapter-item expanded "><a href="0120_dual_character_scenario_template.html">Dual-Character Scenario Template</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="0121_appendix_4_triple_character_personality_scenario.html">Appendix 4 – Triple-Character Personality &amp; Scenario</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="0122_triple_personality_template.html">Triple Personality Template</a></li><li class="chapter-item expanded "><a href="0123_triple_scenario_template.html">Triple Scenario Template</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="0124_appendix_5_scenario_bot_templates.html">Appendix 5 – Scenario Bot Templates</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="0125_example_dragon_ball_z_simulator_scenario_heavy_personality_l.html">Example: “Dragon Ball Z Simulator” (Scenario-heavy, Personality-light)</a></li><li class="chapter-item expanded "><a href="0126_sim_gm_personality_narratorreferee_persona.html">SIM-GM PERSONALITY (Narrator/Referee Persona)</a></li><li class="chapter-item expanded "><a href="0127_character_voice_lite_per_roster_slot_minimal_anchors.html">CHARACTER VOICE LITE (Per-Roster Slot; minimal anchors)</a></li><li class="chapter-item expanded "><a href="0128_shared_scenario_world_rules_pacing.html">SHARED SCENARIO (World, Rules, Pacing)</a></li><li class="chapter-item expanded "><a href="0129_transformation_power_ladder_gate_conditions.html">TRANSFORMATION &amp; POWER LADDER (Gate Conditions)</a></li><li class="chapter-item expanded "><a href="0130_trigger_matrix_stimulus_reaction_one_sentence_each.html">TRIGGER MATRIX (Stimulus → Reaction; one sentence each)</a></li><li class="chapter-item expanded "><a href="0131_escalation_de_escalation_ladders.html">ESCALATION / DE-ESCALATION LADDERS</a></li><li class="chapter-item expanded "><a href="0132_user_controls_prompts_gm_will_surface_as_choices.html">USER CONTROLS (Prompts GM will surface as choices)</a></li><li class="chapter-item expanded "><a href="0133_example_openers_pick_one.html">EXAMPLE OPENERS (Pick one)</a></li><li class="chapter-item expanded "><a href="0134_example_round_compact.html">EXAMPLE ROUND (Compact)</a></li><li class="chapter-item expanded "><a href="0135_drift_recovery_if_the_chat_gets_messy.html">DRIFT RECOVERY (If the chat gets messy)</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded "><a href="0136_appendix_6_glossary_of_key_terms.html">Appendix 6 – Glossary of Key Terms</a></li></ol>';
        // Set the current, active page, and reveal it if it's hidden
        let current_page = document.location.href.toString().split("#")[0].split("?")[0];
        if (current_page.endsWith("/")) {
            current_page += "index.html";
        }
        var links = Array.prototype.slice.call(this.querySelectorAll("a"));
        var l = links.length;
        for (var i = 0; i < l; ++i) {
            var link = links[i];
            var href = link.getAttribute("href");
            if (href && !href.startsWith("#") && !/^(?:[a-z+]+:)?\/\//.test(href)) {
                link.href = path_to_root + href;
            }
            // The "index" page is supposed to alias the first chapter in the book.
            if (link.href === current_page || (i === 0 && path_to_root === "" && current_page.endsWith("/index.html"))) {
                link.classList.add("active");
                var parent = link.parentElement;
                if (parent && parent.classList.contains("chapter-item")) {
                    parent.classList.add("expanded");
                }
                while (parent) {
                    if (parent.tagName === "LI" && parent.previousElementSibling) {
                        if (parent.previousElementSibling.classList.contains("chapter-item")) {
                            parent.previousElementSibling.classList.add("expanded");
                        }
                    }
                    parent = parent.parentElement;
                }
            }
        }
        // Track and set sidebar scroll position
        this.addEventListener('click', function(e) {
            if (e.target.tagName === 'A') {
                sessionStorage.setItem('sidebar-scroll', this.scrollTop);
            }
        }, { passive: true });
        var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
        sessionStorage.removeItem('sidebar-scroll');
        if (sidebarScrollTop) {
            // preserve sidebar scroll position when navigating via links within sidebar
            this.scrollTop = sidebarScrollTop;
        } else {
            // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
            var activeSection = document.querySelector('#sidebar .active');
            if (activeSection) {
                activeSection.scrollIntoView({ block: 'center' });
            }
        }
        // Toggle buttons
        var sidebarAnchorToggles = document.querySelectorAll('#sidebar a.toggle');
        function toggleSection(ev) {
            ev.currentTarget.parentElement.classList.toggle('expanded');
        }
        Array.from(sidebarAnchorToggles).forEach(function (el) {
            el.addEventListener('click', toggleSection);
        });
    }
}
window.customElements.define("mdbook-sidebar-scrollbox", MDBookSidebarScrollbox);
