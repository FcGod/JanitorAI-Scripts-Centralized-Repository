<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Chapter 13 – Dialogue, Formatting &amp; Troubleshooting - Chatbot Creation Guide</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
            window.path_to_searchindex_js = "searchindex.js";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
                sidebar_toggle.checked = false;
            }
            if (sidebar === 'visible') {
                sidebar_toggle.checked = true;
            } else {
                html.classList.remove('sidebar-visible');
            }
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Chatbot Creation Guide</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="chapter-13--dialogue-formatting--troubleshooting"><a class="header" href="#chapter-13--dialogue-formatting--troubleshooting">Chapter 13 – Dialogue, Formatting &amp; Troubleshooting</a></h1>
<h3 id="131-why-dialogue-management-matters"><a class="header" href="#131-why-dialogue-management-matters">13.1 Why Dialogue Management Matters</a></h3>
<p>When multiple characters share the stage, the <em>greatest danger</em> is chaos. Without clear structure, conversations collapse into a muddle: characters talk over each other, voices blur, pacing vanishes, and immersion shatters.</p>
<p><strong>Dialogue management is the craft of controlling conversational flow</strong> — deciding who speaks when, how long they speak, and how their voices remain distinct over time. It is also the framework for troubleshooting breakdowns when characters drift, bleed into each other, or lose rhythm in long chats.</p>
<p>Think of it like directing a play. Even the best actors with perfect lines need a stage manager calling cues. Without that structure, the show descends into noise and missed beats.</p>
<p>In chatbot design, <em>you</em> are that stage manager. Your tools are:</p>
<ul>
<li><strong>The Scenario</strong>, which sets rules for pacing, turn-taking, and escalation.</li>
<li><strong>Formatting rules</strong>, which separate voices on the page and give the LLM a pattern to follow.</li>
</ul>
<p>When managed well, dialogue feels like a live performance: each voice distinct, timing balanced, and rhythm engaging. When neglected, it becomes static prose — or worse, generic chatter that no longer feels like a cast at all.</p>
<h3 id="132-turn-taking-who-speaks-when"><a class="header" href="#132-turn-taking-who-speaks-when">13.2 Turn-Taking: Who Speaks When</a></h3>
<p>In natural human conversation, turn-taking happens automatically. In multi-character bots, the LLM won’t manage this cleanly — it will often let one voice dominate or merge responses together.</p>
<p><strong>Turn-taking rules must be explicit.</strong> Examples include:</p>
<ul>
<li>“After {{user}} speaks, one character responds first, then the second reacts.”</li>
<li>“When both respond, Character One reacts with emotion, Character Two follows with commentary or contrast.”</li>
<li>“Never merge both voices into a single paragraph.”</li>
</ul>
<p><strong>Example (Turn Order Defined):</strong></p>
<ul>
<li>User compliments both.</li>
<li>Response:
<ul>
<li>Character A reacts emotionally first.</li>
<li>Character B follows with a contrasting reaction — teasing A, or echoing differently.</li>
</ul>
</li>
</ul>
<p>This sequencing keeps rhythm predictable and prevents overlap.</p>
<hr />
<h3 id="133-formatting-rules-teaching-the-model-voice-separation"><a class="header" href="#133-formatting-rules-teaching-the-model-voice-separation">13.3 Formatting Rules: Teaching the Model Voice Separation</a></h3>
<p>Formatting isn’t about style points — it’s about teaching the model to <em>see separation of voices.</em> Without clear formatting, characters blur into one mushy voice.</p>
<p><strong>Best Practices:</strong></p>
<ul>
<li><strong>Character Tags:</strong> Always label speakers consistently (e.g., “Claire:” and “Daniel:” or bolded names). Never switch style mid-chat.</li>
<li><strong>Dialogue Markers:</strong> Quotation marks for speech (“...”), italics for actions (<em>...</em>), and square brackets for inner thoughts [...].</li>
<li><strong>Line Break Discipline:</strong> Each speaker always gets their own line. No block paragraphs with blended voices.</li>
</ul>
<p><strong>Example (Good Formatting):</strong><br />
Claire: <em>She adjusts her glasses, eyes darting away.</em> “I… wasn’t expecting that compliment.”<br />
Daniel: <em>A grin spreads across his face.</em> “Yeah, you weren’t, but I live to surprise.”</p>
<p><strong>Example (Bad Formatting):</strong><br />
Claire blushes and says thanks while Daniel laughs and teases her back.</p>
<p>❌ Why bad: Both voices collapsed into one block, no clear speaker separation.</p>
<h3 id="134-pacing-dialogue-length-and-rhythm"><a class="header" href="#134-pacing-dialogue-length-and-rhythm">13.4 Pacing: Dialogue Length and Rhythm</a></h3>
<p>Dialogue pacing defines whether a scene feels like snappy banter or a heavy monologue. In multi-character bots, pacing matters even more — multiple voices must share one turn.</p>
<p><strong>Guidelines:</strong></p>
<ul>
<li><strong>Opening lines = longer.</strong> Use them to anchor the scene.</li>
<li><strong>Banter = short and sharp.</strong> Quick sentences keep rhythm lively.</li>
<li><strong>Emotional or intimate beats = slower.</strong> Let gestures, pauses, and sensory details linger.</li>
<li><strong>Avoid overstuffing.</strong> When two characters respond, each should use 1–3 sentences, not paragraphs.</li>
</ul>
<p><strong>Practical Cue:</strong> Think of pacing like music. Short beats = banter, long beats = reflection. All short beats = shallow. All long beats = heavy. Mixing them creates flow.</p>
<h3 id="135-troubleshooting-common-problems"><a class="header" href="#135-troubleshooting-common-problems">13.5 Troubleshooting Common Problems</a></h3>
<p><strong>1. Personality Bleed</strong></p>
<ul>
<li><em>Symptom:</em> Characters start sounding alike.</li>
<li><em>Fix:</em> Sharpen contrasts in Personality (tone, humor, touch habits). Reinforce Scenario with lines like: “Claire always hesitates; Daniel never does.”</li>
</ul>
<p><strong>2. Voice Merging</strong></p>
<ul>
<li><em>Symptom:</em> Model writes both characters in one block.</li>
<li><em>Fix:</em> Add explicit formatting rules: “Each character speaks on their own line, with name + dialogue.” Reinforce this pattern in Example Dialogue.</li>
</ul>
<p><strong>3. Over-Dominance</strong></p>
<ul>
<li><em>Symptom:</em> One character hogs the stage, others fade.</li>
<li><em>Fix:</em> Add Scenario rules: “After {{user}}, Character A responds first, then Character B must follow.”</li>
</ul>
<p><strong>4. Pacing Collapse</strong></p>
<ul>
<li><em>Symptom:</em> Conflicts or romances resolve instantly.</li>
<li><em>Fix:</em> Add escalation/repair ladders: “Do not resolve arguments in one turn. Conflict must pass through sharpness → silence → softening → repair.”</li>
</ul>
<p><strong>5. Repetition &amp; Drift</strong></p>
<ul>
<li><em>Symptom:</em> Characters reuse the same phrases or forget distinctions.</li>
<li><em>Fix:</em> Insert Scenario reinforcement lines: “Claire is formal, Daniel is casual — this must remain consistent every exchange.”</li>
</ul>
<h3 id="136-case-study-banter-flow-in-a-duo"><a class="header" href="#136-case-study-banter-flow-in-a-duo">13.6 Case Study: Banter Flow in a Duo</a></h3>
<p><strong>Scenario Rule:</strong> Claire responds earnestly; Daniel undercuts with humor.</p>
<p>User: “You two handled that really well.”<br />
Claire: <em>Her cheeks warm as she glances at the floor.</em> “Oh… I mean, we tried our best.”<br />
Daniel: <em>He smirks, elbow nudging Claire.</em> “Tried our best? Please. We crushed it.”</p>
<p>✅ Why it works: Claire shows humility, Daniel adds confidence. Turn-taking is clear, voices are distinct, pacing is playful.</p>
<h3 id="137-case-study-triangulation-in-a-trio"><a class="header" href="#137-case-study-triangulation-in-a-trio">13.7 Case Study: Triangulation in a Trio</a></h3>
<p><strong>Scenario Rule:</strong> Ethan leads, Maya resists, Chris mediates.</p>
<p>User: “So… who actually made the smart choice here?”<br />
Ethan: <em>Brows furrow, voice clipped.</em> “Obviously me. I kept us alive.”<br />
Maya: <em>She snorts, arms crossed.</em> “Alive, sure. Inspired? Not even close.”<br />
Chris: <em>He steps between them, grinning.</em> “If survival and style were both categories, you’d both win. But they’re not. So let’s call it a tie.”</p>
<p>✅ Why it works: Distinct voices, clear turn order (Leader → Challenger → Mediator), pacing builds tension then cools it.</p>
<h3 id="138-diagram-prompt"><a class="header" href="#138-diagram-prompt">13.8 Diagram Prompt</a></h3>
<p><strong>Title:</strong> “Multi-Character Dialogue Flow”<br />
<strong>Design:</strong></p>
<ul>
<li>Three circles: Character A, Character B, Character C.</li>
<li>Flow lines show sequence: A to B to C to back to A.</li>
<li>Beneath: pacing icons (short line = banter, long line = reflection).</li>
<li>Use contrasting colors for each character to emphasize distinct voices.</li>
</ul>
<h3 id="139-conclusion"><a class="header" href="#139-conclusion">13.9 Conclusion</a></h3>
<p>Dialogue is where a multi-character bot succeeds or fails. Personality, Scenario, and Triggers mean nothing if voices collapse in the transcript. By controlling <strong>turn-taking, formatting, and pacing</strong>, you give the model rails to follow that feel natural and theatrical.</p>
<p>Troubleshooting ensures that when drift inevitably happens, you can pull the bot back on track — sharpening contrasts, reinforcing formatting, and adjusting pacing cues.</p>
<p>Always remember: the user isn’t just chatting with characters — they are <em>watching a performance.</em> Your role is to make sure the play runs smoothly, voices stay distinct, and the rhythm keeps the audience hooked.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="0094_12b_template_trio_character_shared_scenario_trigger_matrix.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="0096_chapter_14_scenario_bots_i_foundations_simulation.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="0094_12b_template_trio_character_shared_scenario_trigger_matrix.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="0096_chapter_14_scenario_bots_i_foundations_simulation.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->



    </div>
    </body>
</html>
